<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Stickman Maze: The Wolf's Gauntlet</title>
    <style>
        body { background: #111; color: #fff; font-family: sans-serif; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; margin: 0; overflow: hidden; }
        #ui { text-align: center; margin-bottom: 10px; z-index: 10; }
        canvas { background: #fff; border: 5px solid #444; box-shadow: 0 0 30px #000; display: block; border-radius: 4px; }
        .stats { font-size: 1.4em; font-weight: bold; color: #3498db; }
        #hp-bar { width: 300px; height: 12px; background: #333; margin: 10px auto; display: none; border-radius: 6px; border: 2px solid #555; overflow: hidden; }
        #hp-fill { width: 100%; height: 100%; background: #e74c3c; transition: width 0.1s; }
    </style>
</head>
<body>

<div id="ui">
    <div id="lvl-name" class="stats">LEVEL 1</div>
    <div id="status">WASD to Move | SHIFT to Run | SPACE to Attack</div>
    <div id="hp-bar"><div id="hp-fill"></div></div>
</div>

<canvas id="gameCanvas"></canvas>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');

const TILE = 40;
const COLS = 15;
const ROWS = 11;
canvas.width = COLS * TILE;
canvas.height = ROWS * TILE;

let currentLevel = 1;
let frame = 0;
const keys = {};

const player = { x: 60, y: 60, speed: 2.5, dir: 1, state: 'idle' };
const hunter = { x: 0, y: 0, speed: 1.5, active: false, dir: 1, state: 'idle' };
const queen = { x: 0, y: 0, speed: 1.8, active: false, hp: 100, vx: 1, vy: 1 };
const wolf = { x: 0, y: 0, speed: 3.2, active: false, hp: 200, state: 'idle', jump: 0 };

// 0 = Path, 1 = Wall, 2 = Exit
const maps = {
    1: [[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,1,0,0,0,0,0,0,0,0,0,1],[1,0,1,0,1,0,1,1,1,1,1,0,1,0,1],[1,0,1,0,0,0,1,0,0,0,1,0,1,0,1],[1,0,1,1,1,1,1,0,1,0,1,1,1,0,1],[1,0,0,0,0,0,0,0,1,0,0,0,0,0,1],[1,1,1,1,1,1,1,0,1,1,1,1,1,0,1],[1,0,0,0,0,0,1,0,0,0,0,0,1,0,1],[1,0,1,1,1,0,1,1,1,1,1,0,1,0,1],[1,0,0,0,1,0,0,0,0,0,0,0,0,2,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],
    2: [[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,1,0,0,0,0,0,1],[1,0,1,1,1,1,1,0,1,0,1,1,1,0,1],[1,0,1,0,0,0,1,0,1,0,1,0,0,0,1],[1,0,1,0,1,0,1,0,1,0,1,0,1,1,1],[1,0,0,0,1,0,0,0,0,0,1,0,0,0,1],[1,1,1,1,1,1,1,0,1,1,1,1,1,0,1],[1,0,0,0,0,0,0,0,1,0,0,0,0,0,1],[1,0,1,1,1,1,1,1,1,0,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,2,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],
    3: [[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,1,0,0,0,0,0,0,0,1],[1,0,1,1,1,0,1,0,1,1,1,1,1,0,1],[1,0,1,0,0,0,1,0,0,0,1,0,0,0,1],[1,0,1,0,1,1,1,1,1,0,1,0,1,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,1,0,1],[1,0,1,1,1,1,1,0,1,1,1,1,1,0,1],[1,0,1,0,0,0,1,0,0,0,0,0,0,0,1],[1,0,1,0,1,0,1,1,1,1,1,1,1,0,1],[1,0,0,0,1,0,0,0,0,0,0,0,0,2,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],
    4: [[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,2,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],
    5: [[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,0,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,0,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,0,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,0,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,2,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],
    6: [[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,1,1,1,1,1,0,1,1,1,1,1,0,1],[1,0,1,0,0,0,0,0,0,0,0,0,1,0,1],[1,0,1,0,1,1,1,0,1,1,1,0,1,0,1],[1,0,1,0,1,0,0,0,0,0,1,0,1,0,1],[1,0,1,0,1,0,1,2,1,0,1,0,1,0,1],[1,0,1,0,1,0,0,0,0,0,1,0,1,0,1],[1,0,1,0,1,1,1,1,1,1,1,0,1,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],
    7: [[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,1,0,0,0,0,1,0,0,0,0,1,0,1],[1,0,1,0,1,1,0,1,0,1,1,0,1,0,1],[1,0,0,0,1,2,0,0,0,0,1,0,0,0,1],[1,1,1,0,1,1,1,1,1,1,1,0,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,1,1,1,1,1,0,1,1,1,1,1,0,1],[1,0,0,0,0,0,1,0,1,0,0,0,0,0,1],[1,1,1,1,1,0,1,0,1,0,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],
    8: [[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,1,0,0,0,0,0,0,1],[1,1,1,1,1,1,0,1,0,1,1,1,1,1,1],[1,0,0,0,0,0,0,1,0,0,0,0,0,0,1],[1,0,1,1,1,1,1,1,1,1,1,1,1,0,1],[1,0,0,0,0,0,0,1,0,0,0,0,0,0,1],[1,1,1,1,1,1,0,1,0,1,1,1,1,1,1],[1,0,0,0,0,0,0,1,0,0,0,0,0,0,1],[1,0,1,1,1,1,1,1,1,1,1,1,1,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,2,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],
    9: [[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,1,0,0,0,0,1],[1,1,1,1,1,1,1,1,0,1,0,1,1,1,1],[1,0,0,0,0,0,0,0,0,1,0,0,0,0,1],[1,0,1,1,1,1,1,1,1,1,1,1,1,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,0,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,1,0,0,0,0,0,1],[1,0,1,1,1,1,1,0,1,0,1,1,1,0,1],[1,0,0,0,0,0,0,0,1,0,0,0,0,2,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],
    10: [[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,1,1,1,1,1,1,1,1,1,1,1,0,1],[1,0,1,0,0,0,0,0,0,0,0,0,1,0,1],[1,0,1,0,1,1,1,1,1,1,1,0,1,0,1],[1,0,1,0,1,0,0,0,0,0,1,0,1,0,1],[1,0,1,0,1,0,1,2,1,0,1,0,1,0,1],[1,0,1,0,1,0,0,0,0,0,1,0,1,0,1],[1,0,1,0,1,1,1,1,1,1,1,0,1,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],
    11: [[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,1,0,0,0,1,0,0,0,1,0,1],[1,1,1,0,1,0,1,0,1,0,1,0,1,0,1],[1,0,0,0,0,0,1,0,0,0,1,0,0,0,1],[1,0,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,2,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],
    12: [[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,1,0,0,0,0,0,0,0,1],[1,0,1,1,1,0,1,0,1,1,1,1,1,0,1],[1,0,1,0,0,0,1,0,0,0,1,0,0,0,1],[1,0,1,0,1,1,1,1,1,0,1,0,1,0,1],[1,0,0,0,1,2,1,0,0,0,0,0,1,0,1],[1,0,1,1,1,1,1,0,1,1,1,1,1,0,1],[1,0,1,0,0,0,1,0,0,0,0,0,0,0,1],[1,0,1,0,1,0,1,1,1,1,1,1,1,0,1],[1,0,0,0,1,0,0,0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]],
    13: [[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],[1,0,0,0,0,0,0,0,0,0,0,0,0,2,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]]
};

function drawWolf(x, y) {
    ctx.save();
    ctx.translate(x, y + wolf.jump);
    ctx.fillStyle = "#555";
    ctx.fillRect(-40, -20, 80, 40);
    ctx.fillRect(25, -35, 30, 25);
    ctx.fillStyle = "red";
    ctx.fillRect(45, -30, 6, 6);
    ctx.fillStyle = "#333";
    ctx.fillRect(-35, 20, 12, 20); ctx.fillRect(20, 20, 12, 20);
    ctx.restore();
}

function drawStickman(x, y, color, scale, isQueen = false, entity) {
    ctx.save();
    ctx.translate(x, y);
    ctx.strokeStyle = color;
    ctx.lineWidth = 3 * scale;
    ctx.lineCap = 'round';
    const legSwing = (entity.state !== 'idle') ? Math.sin(frame * 0.2) * 10 : 0;
    ctx.beginPath();
    ctx.arc(0, -18 * scale, 6 * scale, 0, Math.PI * 2);
    ctx.stroke();
    ctx.beginPath();
    ctx.moveTo(0, -12 * scale); ctx.lineTo(0, 8 * scale);
    if (entity.state === 'fight') {
        ctx.moveTo(0, -5 * scale); ctx.lineTo(20 * scale * (entity.dir || 1), -5 * scale);
    } else {
        ctx.moveTo(0, -5 * scale); ctx.lineTo(-8 * scale, 5 * scale);
        ctx.moveTo(0, -5 * scale); ctx.lineTo(8 * scale, 5 * scale);
    }
    ctx.moveTo(0, 8 * scale); ctx.lineTo(legSwing * scale, 22 * scale);
    ctx.moveTo(0, 8 * scale); ctx.lineTo(-legSwing * scale, 22 * scale);
    ctx.stroke();
    if (isQueen) {
        ctx.fillStyle = "gold";
        ctx.beginPath(); ctx.moveTo(-10, -30); ctx.lineTo(0, -45); ctx.lineTo(10, -30); ctx.fill();
    }
    ctx.restore();
}

function isWall(x, y) {
    const r = 8;
    const map = maps[currentLevel];
    const points = [[x-r, y-r], [x+r, y-r], [x-r, y+r], [x+r, y+r]];
    for (let p of points) {
        let gx = Math.floor(p[0] / TILE), gy = Math.floor(p[1] / TILE);
        if (gy < 0 || gy >= ROWS || gx < 0 || gx >= COLS || map[gy][gx] === 1) return true;
    }
    return false;
}

function initLevel(lvl) {
    currentLevel = lvl;
    player.x = 60; player.y = 60;
    document.getElementById('lvl-name').innerText = "LEVEL " + lvl;
    document.getElementById('hp-bar').style.display = (lvl === 4 || lvl === 13) ? 'block' : 'none';

    hunter.active = (lvl === 3);
    if(hunter.active) { hunter.x = 540; hunter.y = 380; hunter.state = 'walk'; }

    queen.active = (lvl === 4);
    if(queen.active) { queen.x = 300; queen.y = 200; queen.hp = 100; }

    wolf.active = (lvl === 13);
    if(wolf.active) { wolf.x = 400; wolf.y = 200; wolf.hp = 200; }
}

function update() {
    frame++;
    let s = keys['shift'] ? player.speed * 1.7 : player.speed;
    let dx = 0, dy = 0;
    if (keys['w']) dy -= s; if (keys['s']) dy += s;
    if (keys['a']) { dx -= s; player.dir = -1; }
    if (keys['d']) { dx += s; player.dir = 1; }
    if (dx !== 0 && !isWall(player.x + dx, player.y)) player.x += dx;
    if (dy !== 0 && !isWall(player.x, player.y + dy)) player.y += dy;
    player.state = (dx !== 0 || dy !== 0) ? 'walk' : 'idle';
    if (keys[' ']) player.state = 'fight';

    if (hunter.active) {
        let hdx = player.x > hunter.x ? hunter.speed : -hunter.speed;
        let hdy = player.y > hunter.y ? hunter.speed : -hunter.speed;
        if (!isWall(hunter.x + hdx, hunter.y)) { hunter.x += hdx; hunter.dir = hdx > 0 ? 1 : -1; }
        if (!isWall(hunter.x, hunter.y + hdy)) { hunter.y += hdy; }
        if (Math.hypot(player.x - hunter.x, player.y - hunter.y) < 25) {
            alert("The Hunter caught you!");
            initLevel(3);
        }
    }

    if (queen.active) {
        queen.x += queen.vx * queen.speed; queen.y += queen.vy * queen.speed;
        if (isWall(queen.x, queen.y)) { queen.vx *= -1; queen.vy *= -1; }
        if (player.state === 'fight' && Math.hypot(player.x - queen.x, player.y - queen.y) < 50) {
            queen.hp -= 0.5;
            document.getElementById('hp-fill').style.width = (queen.hp/100)*100 + "%";
            if (queen.hp <= 0) queen.active = false;
        }
    }

    if (wolf.active) {
        let dist = Math.hypot(player.x - wolf.x, player.y - wolf.y);
        if (frame % 80 < 40) {
            wolf.x += (player.x > wolf.x ? 1 : -1) * wolf.speed;
            wolf.y += (player.y > wolf.y ? 1 : -1) * wolf.speed;
            wolf.jump = 0;
        } else {
            wolf.jump = -15;
        }
        if (player.state === 'fight' && dist < 70) {
            wolf.hp -= 0.5;
            document.getElementById('hp-fill').style.width = (wolf.hp/200)*100 + "%";
            if (wolf.hp <= 0) wolf.active = false;
        }
        if (dist < 30) { alert("The Wolf got you!"); initLevel(13); }
    }

    const gx = Math.floor(player.x / TILE), gy = Math.floor(player.y / TILE);
    if (maps[currentLevel] && maps[currentLevel][gy][gx] === 2) {
        if ((currentLevel === 4 && queen.active) || (currentLevel === 13 && wolf.active)) return;
        if (currentLevel < 13) initLevel(currentLevel + 1);
        else { alert("YOU DEFEATED THE WOLF!"); location.reload(); }
    }
}

function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    const map = maps[currentLevel];
    for (let r = 0; r < ROWS; r++) {
        for (let c = 0; c < COLS; c++) {
            if (map[r][c] === 1) { ctx.fillStyle = '#2c3e50'; ctx.fillRect(c * TILE, r * TILE, TILE, TILE); }
            else if (map[r][c] === 2) { ctx.fillStyle = '#2ecc71'; ctx.fillRect(c * TILE, r * TILE, TILE, TILE); }
        }
    }
    if (hunter.active) drawStickman(hunter.x, hunter.y, '#e74c3c', 1.2, false, hunter);
    if (queen.active) drawStickman(queen.x, queen.y, '#9b59b6', 2.3, true, queen);
    if (wolf.active) drawWolf(wolf.x, wolf.y);
    drawStickman(player.x, player.y, '#3498db', 1, false, player);
    update();
    requestAnimationFrame(draw);
}

window.onkeydown = (e) => keys[e.key.toLowerCase()] = true;
window.onkeyup = (e) => keys[e.key.toLowerCase()] = false;
initLevel(1);
draw();
</script>
</body>
</html>
